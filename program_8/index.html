<!DOCTYPE html>
<html lang="en">

<head>

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <meta charset=utf-8 />
	<title>Client Side Pagination</title>
	<link rel="stylesheet" type="text/css" media="screen" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="./css/font-awesome.css" />
	<script   src="https://code.jquery.com/jquery-2.2.4.js"   integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI="   crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	<script src="./plugin/jquery.twbsPagination.js"></script>
	<script src="./js/cookies.js"></script>
    
    
    <title>Shop Homepage - Start Bootstrap Template</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/shop-homepage.css" rel="stylesheet">

    
    	<style>

        #pleaseWaitDialog {
            width: 400px;
            height: 50px;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-top: -25px;
            margin-left: -200px;
            padding: 20px;
        }

        /* When the body has the loading class, we turn
           the scrollbar off with overflow:hidden */
        body.loading {
            overflow: hidden;   
        }

        /* Anytime the body has the loading class, our
           modal element will be visible */
        body.loading .modal {
            display: block;
        }
        
        .col-centered{
            float: none;
            margin: 0 auto;
        }
        
        .modal-header {
            padding-bottom: 5px;
        }

        .modal-footer {
                padding: 0;
            }
    
        .modal-footer .btn-group button {
            height:40px;
            border-top-left-radius : 0;
            border-top-right-radius : 0;
            border: none;
            border-right: 1px solid #ddd;
        }
    
        .modal-footer .btn-group:last-child > button {
            border-right: 0;
        }
		
		body {
			padding:20px;
		}
        
	</style>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="http://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="http://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>



    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Start Bootstrap</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="#">About</a>
                    </li>
                    <li>
                        <a href="#">Services</a>
                    </li>
                    <li>
                        <a href="#">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Content -->
    <div class="container">

        <div class="row">

            <div class="col-md-3">
                <p class="lead">Shop Name</p>
                <div class="list-group">

                </div>
            </div>

            <div class="col-md-9">

                <div class="row carousel-holder">

                    <div class="col-md-12">
                        <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
                            <ol class="carousel-indicators">
                                <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
                                <li data-target="#carousel-example-generic" data-slide-to="1"></li>
                                <li data-target="#carousel-example-generic" data-slide-to="2"></li>
                            </ol>
                            <div class="carousel-inner">
                                <div class="item active">
                                    <img class="slide-image" src="http://4.bp.blogspot.com/-JnoNBgsARt4/VNZYxruJj2I/AAAAAAAAIcg/t7Vfn9m3V2g/s1600/Gaming%2BConsole%2Bprice.png">
                                </div>
                                <div class="item">
                                    <img class="slide-image" src="http://haterateindia.com/wp-content/uploads/2016/02/Best-laptops-India-Under-30000.jpg">
                                </div>
                                <div class="item">
                                    <img class="slide-image" src="http://www.americandronesonline.com/wp-content/uploads/2016/02/Drone-with-Camera-800x300.jpg">
                                </div>
                            </div>
                            <a class="left carousel-control" href="#carousel-example-generic" data-slide="prev">
                                <span class="glyphicon glyphicon-chevron-left"></span>
                            </a>
                            <a class="right carousel-control" href="#carousel-example-generic" data-slide="next">
                                <span class="glyphicon glyphicon-chevron-right"></span>
                            </a>
                        </div>
                    </div>

                </div>

                <div class="row-prod">

                </div>

            </div>

        </div>

    </div>
    <!-- /.container -->

    <div class="container">

        <hr>

        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
                    <p>Copyright &copy; Web-Dev Summer 2016</p>
                </div>
            </div>
        </footer>

    </div>
    
    
    <div class="row">
  <div class="col-xs-12 col-sm-8"><center>
      <ul id="pagination-demo" class="pagination-sm"></ul>
      </center>
</div>

<div class="modal hide" id="pleaseWaitDialog" data-backdrop="static" data-keyboard="false">
        <div class="modal-header">
            <h1>Processing...</h1>
        </div>
        <div class="modal-body">
            <div class="progress progress-striped active">
                <div class="bar" style="width: 100%;"></div>
            </div>
        </div>
    </div>
</div>
    <!-- /.container -->

    <!-- jQuery -->
 
    
<script>
//console.log("hit")
(function($) {
    
    var myWait;
    myWait = myWait || (function () {
        var waitDiv = $('<div class="modal" id="pleaseWaitDialog" data-backdrop="static" data-keyboard="false"><div class="progress"> <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:98%"> LOADING... </div></div></div>');
        return {
            show: function() {
                waitDiv.modal();
            },
            hide: function () {
                waitDiv.modal('hide');
            },

        };
    })();


    myWait.show();

    // Set up some variables for our pagination
    var page = 1;
    var page_size = 10;
    var total_records = 0;
    var total_pages = 0;
    var rows = "";
    var col_head = "";
    
    
    function loadTableData(page, page_size,sort,order) {
        //console.log("hit")    
		var sort = typeof sort !== 'undefined' ?  sort.trim() : "id";
		var order = typeof order !== 'undefined' ?  ","+order : "";
    
        //myWait.show();
                
        $.get("http://107.170.39.161/api/api.php/products?order="+sort+order+"&page=" + page + "," + page_size)

        
        // The '.done' method fires when the get request completes
        .done(function(data) {
        
            // Pull the column names out of our json object 
            var rowdata = data.products.records;
            var row = "";

            for (var i = 0; i < rowdata.length; i++) {
                 var image = rowdata[i][4];
                 var price = rowdata[i][3]
                 image = image.replace('~','280');
                 image = image.split(" ");
                 var text = rowdata[i][2].split(" ");
                 text = text[0] + " " + text[1];
                 
                 row += "<div class=\"col-sm-4 col-lg-4 col-md-4\">"
                       + "<div class=\"thumbnail\">"
                           + "<img id=\"image\" src=\""+image[0]+"\" alt=\"\">"
                            +"<div class=\"caption\">"
                               + "<h4 class=\"pull-right\">$" + price + "</h4>"
                               + "<h4><a class=\"des\" href=\"#\">"+ text +"</a>"
                               + "</h4>"
                               + " <p>" + rowdata[i][2] + "</p>"
                            +"</div>"
                            +"<div class=\"ratings\">"
                               + "<p class=\"pull-right\">15 reviews</p>"
                               + "<p>"
                                   + "<span class=\"glyphicon glyphicon-star\"></span>"
                                   + "<span class=\"glyphicon glyphicon-star\"></span>"
                                   + "<span class=\"glyphicon glyphicon-star\"></span>"
                                   + "<span class=\"glyphicon glyphicon-star\"></span>"
                                   + "<span class=\"glyphicon glyphicon-star\"></span>"
                               + "</p>"
                           + "</div>"
                        + "</div>"
                   + "</div>"	
            }
            // Append our new html to this pages only 'thead' tag
            $('.row-prod').html(row);
            
            myWait.hide();
			

    

        });
    } // End .done
	
    
function getTotalCategories(){
    $.get("http://107.170.39.161/api/api.php/categories")
    .done(function(data){
    
    var categoryData = data.categories.records;
    var categoryElement = "";
        for(var j = 0 ; j < categoryData.length; j++){
            var categoryName = categoryData[j][1].toUpperCase();
           
            categoryElement +=  "<button type=\"button\" class=\"list-group-item\" id=\"categoryId\">" + categoryName + "</button>";
         
            //console.log(categoryElement);
        }
        $('.list-group').html(categoryElement);
    
        $('.list-group-item').click(function(event){
            text = $(this).text();
            console.log(text);
            loadSelectedCat(text);
        });
    
    });

}	

    
    function loadSelectedCat(text){
      load(text,1,12);
    
    }
    
          function load(text, page, page_size){
        $.get("http://107.170.39.161/api/api.php/products?order=id&page=" + page + "," + page_size + "&filter=category,eq," + text)
        .done(function(data) {
        
            // Pull the column names out of our json object 
            var rowdata = data.products.records;
            var row = "";

            for (var i = 0; i < rowdata.length; i++) {
                 var image = rowdata[i][4];
                 var price = rowdata[i][3]
                 image = image.replace('~','280');
                 image = image.split(" ");
                 var text = rowdata[i][2].split(" ");
                 text = text[0] + " " + text[1];
                 
                 row += "<div class=\"col-sm-4 col-lg-4 col-md-4\">"
                       + "<div class=\"thumbnail\">"
                           + "<img id=\"image\" src=\""+image[0]+"\" alt=\"\">"
                            +"<div class=\"caption\">"
                               + "<h4 class=\"pull-right\">$" + price + "</h4>"
                               + "<h4><a class=\"des\" href=\"#\">"+ text +"</a>"
                               + "</h4>"
                               + " <p>" + rowdata[i][2] + "</p>"
                            +"</div>"
                            +"<div class=\"ratings\">"
                               + "<p class=\"pull-right\">15 reviews</p>"
                               + "<p>"
                                   + "<span class=\"glyphicon glyphicon-star\"></span>"
                                   + "<span class=\"glyphicon glyphicon-star\"></span>"
                                   + "<span class=\"glyphicon glyphicon-star\"></span>"
                                   + "<span class=\"glyphicon glyphicon-star\"></span>"
                                   + "<span class=\"glyphicon glyphicon-star\"></span>"
                               + "</p>"
                           + "</div>"
                        + "</div>"
                   + "</div>"	
            }
            // Append our new html to this pages only 'thead' tag
            $('.row-prod').html(row);

        });
        }
    
    function getTotalPages(){
        $.get("http://107.170.39.161/api/api.php/products")

        // The '.done' method fires when the get request completes
        .done(function(data) {

            total_records = data.products.records.length;
            total_pages = parseInt(total_records / page_size);
            loadTableData(1, 12);
            getTotalCategories();
               
 
           $('#pagination-demo').twbsPagination({
                totalPages: total_pages,
                visiblePages: 10,
                onPageClick: function (event, page) {
                    $('#page-content').text('Page ' + page);
                    if(typeof text === 'undefined')
                        loadTableData(page,12);
                    else
                        load(text, page, 12);
                }
            });
            
            //"http://107.170.39.161/api/api.php/products?order=id&page=" + page + "," + page_size + "&filter=category,eq," + category
            
            			
        });

    }


        getTotalPages();

 
    
	 function guid() {
	  function s4() {
		return Math.floor((1 + Math.random()) * 0x10000)
		  .toString(16)
		  .substring(1);
	  }
	  return s4() + s4() + '-' + s4() + '-' + s4() + '-' +
		s4() + '-' + s4() + s4() + s4();
	}
	

   


}(jQuery));
    
    </script>

</body>

</html>
